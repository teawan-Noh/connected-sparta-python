<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Webpage Title -->
    <title>Tour Product | CONNECTED</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- og태그 & Favicon -->
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <meta property="og:title" content="connected"/>
    <meta property="og:description" content="mini project for Web Plus"/>
    <meta property="og:image" content="{{ url_for('static', filename='ogimg.png') }}"/>
    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <link href="{{ url_for('static', filename='mystyle.css') }}" rel="stylesheet">
    <!-- Font Awesome CSS -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Righteous&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script src="{{ url_for('static', filename='myjs.js') }}"></script>

    <script>
    let value = '{{ result }}'
    $(document).ready(function () {
        get_products()
        if (value == 'guide') {
            toggle_guide_product()
        }
    })
    let product_list = [];
    for (let i = 0; i < value.length; i++) {
       product_list.push(value[i])
    }
    function search_product() {
        let oldVal = $("#searchInput").val()
        /* 검색 내용 변경 감지 */
        $("#searchInput").on("propertychange change keyup paste input", function () {
            // 변화에 바로바로 반응하면 부하가 걸릴 수 있어서 1초 딜레이를 준다.
            setTimeout(function () {
            // 변경된 현재 박스 값을 받아온다.
            let currentVal = $("#searchInput").val()
            if (currentVal == oldVal) {
                return;
            }
            var listArray = `${products}`.toArray();
            // forEach의 첫번째 인자값 = 배열 내 현재 값
            // 두번째 값 = index
            // 세번째 값 = 현재 배열
            listArray.forEach(function (c, i) {
                var currentList = c;
                // 현재 배열값에서 내용 추출
                var currentListText = c.innerText;
                // 검색 내용을 포함하지 않을 경우
                if (currentListText.includes(currentVal) == false) {
                    {#currentList.style.display = "none";#}
                    alert("결과가 없습니다")
                }
                // 검색 내용을 포함할 경우
                if (currentListText.includes(currentVal)) {
                    {#currentList.style.display = "block";#}
                    alert("결과")
                }
                // 검색 내용이 없을 경우
                if (currentVal.trim() == "") {
                    currentList.style.display = "block";
                }
            });
            }, 1000);
         });
    }

    </script>
    <style>
        .is-grouped {
            margin: 30px auto;
            width: 580px;
        }
        .searchInput {
            width: 520px;
            height: 64px;
            padding-left: 24px;
            color: #202020;
            font-size: 18px;
            border: 0;
            border-radius: 16px;
            box-shadow: 0 8px 16px 0 rgb(32 32 32 / 8%);
        }

        .is-info {
            position: relative;
            width: 64px;
            height: 64px;
            border-radius: 16px;
            background: #569aff;
            -webkit-box-shadow: 0 8px 16px 0 rgb(35 0 104 / 16%);
            box-shadow: 0 8px 16px 0 rgb(35 0 104 / 16%);
        }
        .product_box {
            width: 1200px;
            margin: auto;
        }
        .section_subtitle {
            font-family: 'Jua', sans-serif;
            width:9%;
            margin: 50px auto 30px;
            display: flex;
            font-size: 30px;
            color: navy;
        }
        .card-list {
            margin-top: 60px;
            width: 1200px;
            display: flex;
            flex-wrap: wrap;
            flex-direction: row;
        }
        .card {
            margin: 24px;
        }
    </style>
</head>
<body>
{% include 'mainHeader.html' %}

    <section class="product_box">
        <h3 class="section_subtitle">투어 상품</h3>
        <div id="button-guide" class="level-item is-hidden">
            <a class="button" onclick="go_posting()">투어 상품 게시</a>
        </div>
        <div class="field is-grouped">
            <p class="control is-expanded">
                <input id="searchInput" class="searchInput" type="text" placeholder="키워드를 검색하세요.">
            </p>
            <p class="control">
                <a class="button is-info" onclick="search_product()"><i class="fa fa-search"></i></a>
            </p>
        </div>
        <div id="product-box" class="card-list">
            <div class="card">
            <div class="card-image">
                <figure class="image is-4by3">
                    <img src={{ url_for("static", filename="profile_placeholder.png") }} alt="Image">
                </figure>
            </div>
            <div class="card-content">
                <div class="content">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                    Phasellus nec iaculis mauris. <a>@bulmaio</a>.
                    <a href="#">#css</a> <a href="#">#responsive</a>
                    <br>
                    <time datetime="2016-1-1">11:09 PM - 1 Jan 2016</time>
                </div>
            </div>
        </div>
        </div>
    </section>
</body>
</html>