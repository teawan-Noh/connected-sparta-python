<!doctype html>
<html lang="en">
<head>
    <!-- Webpage Title -->
    <title>Mypage | CONNECTED</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta property="og:title" content="CONNECTED - ì—¬í–‰ì & ê°€ì´ë“œ ì—°ê²° í”Œë«í¼"/>

    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <link href="{{ url_for('static', filename='mystyle.css') }}" rel="stylesheet">
    <!-- Font Awesome CSS -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Righteous&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>

    <!-- kakao login/logout -->
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <script src="{{ url_for('static', filename='login.js') }}"></script>
    <script>
        $(function () {
            $("input[name='pwdchk']").focusout(function () {
                var pwd_value = $("input[name='pwd']").val().replace(/\s/gi, "");
                var pwdchk_value = $("input[name='pwdchk']").val().replace(/\s/gi, "");

                //ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬
                var regulPw = /^(?=.*[a-zA-Z])(?=.*[!@#$%^*+=-])(?=.*[0-9]).{8,20}$/;
                ;
                var regResult = regulPw.test(pwd_value);

                if (!regResult) {
                    alert("ì˜ì–´ ëŒ€ì†Œë¬¸ì,ìˆ«ì,íŠ¹ìˆ˜ë¬¸ì í¬í•¨í•´ì„œ 8ìë¦¬ì—ì„œ 20ìë¦¬ ì‚¬ì´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    $("input[name='pwd']").val('');
                    $("input[name='pwd']").focus();
                }

                //ì¼ì¹˜ì—¬ë¶€
                if (pwd_value != pwdchk_value) {
                    $("#pwChkSpan").html("ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                    $("#pwChkSpan").css({"color": "tomato"});
                    $("input[name='pwd']").val('');
                    $("input[name='pwdchk']").val('');
                    $("input[name='pwd']").focus();
                    return false;
                } else if (pwd_value == pwdchk_value) {
                    $("#pwChkSpan").html("ì¼ì¹˜í•©ë‹ˆë‹¤.");
                    $("#pwChkSpan").css({"color": "blue"});
                }

                if (!pwd_value) {
                    alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                    $("#pwChkSpan").html("");
                    return false;
                }

                if (!pwdchk_value) {
                    alert("ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                    $("#pwChkSpan").html("");
                    return false;
                }
            });
            //ìˆ˜ì • ë²„íŠ¼ì„ ëˆŒë €ì„ë•Œ ë‚˜ë¨¸ì§€ ìœ íš¨ì„± ê²€ì‚¬
            $("#updatebtn").click(function () {

                //ë¹„ë°€ë²ˆí˜¸
                var pwd_value = $("input[name='pwd']").val().replace(/\s/gi, "");

                if (!pwd_value) {
                    alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                    $("input[name='pwd']").focus();
                    return false;
                }

                //ë¹„ë°€ë²ˆí˜¸ í™•ì¸
                var pwdchk_value = $("input[name='pwdchk']").val().replace(/\s/gi, "");

                if (!pwdchk_value) {
                    alert("ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
                    $("input[name='pwdchk']").focus();
                    return false;
                }

                //ìš°í¸ë²ˆí˜¸
                var postcode_value = $("input[name='postcode']").val().replace(/\s/gi, "");

                if (!postcode_value) {
                    alert("ìš°í¸ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    $("input[name='postcode']").focus();
                    return false;
                }

                //ì£¼ì†Œ
                var address_value = $("input[name='address']").val();

                if (!address_value) {
                    alert("ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    $("input[name='address']").focus();
                    return false;
                }

                //ìƒì„¸ì£¼ì†Œ
                var address2_value = $("input[name='address2']").val();

                if (!address2_value) {
                    alert("ìƒì„¸ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    $("input[name='address2']").focus();
                    return false;
                }

                //ì—°ë½ì²˜
                var tel_value = $("input[name='tel']").val().replace(/\s/gi, "");

                if (!tel_value) {
                    alert("ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    $("input[name='tel']").focus();
                    return false;
                }

                var regulTel = /^[0-9]{2,3}-[0-9]{3,4}-[0-9]{4}/;
                var regTelResult = regulTel.test(tel_value);

                if (!regTelResult) {
                    alert("ì „í™”ë²ˆí˜¸ëŠ” 010-0000-0000 í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    $("input[name='tel']").focus();
                    return false;
                }
                //ì´ë©”ì¼
                var email_value = $("input[name='email']").val().replace(/\s/gi, "");

                if (!email_value) {
                    alert("ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    $("input[name='email']").focus();
                    return false;
                }

                var regulEmail = /^[A-Za-z0-9_\.\-]+@[A-Za-z0-9\-]+\.[A-Za-z0-9\-]{2,3}/;
                var regEmailResult = regulEmail.test(email_value);

                if (!regEmailResult) {
                    alert("ì´ë©”ì¼ì„ í˜•ì‹ì— ë§ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    $("input[name='email']").focus();
                    return false;
                }

                alert("ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
            });
        });
    </script>

    <style>
        .wrap {
            width: 1200px;
            margin: auto;
            display: flex;
        }
        .subtitle {
            margin: 10px 30px;
            font-family: 'Jua', sans-serif;
            font-size: 40px;
        }
        .section2 {
            display: flex;
            width: 800px;
            height: 150px;
            margin: 40px 50px;
        }
        .info_title{
            font-size: 20px;
            font-family: 'Jua', sans-serif;
            padding-top: 30px;
            width: 120px;
        }
        .my_input {
            width: 520px;
            height: 50px;
            margin-top: 20px;
            padding-left: 24px;
            color: #202020;
            font-size: 18px;
            border: 0;
            border-radius: 16px;
            box-shadow: 0 8px 16px 0 rgb(32 32 32 / 8%);
        }
        .my_input2 {
            width: 380px;
            height: 50px;
            margin-top: 20px;
            padding-left: 24px;
            color: #202020;
            font-size: 18px;
            border: 0;
            border-radius: 16px;
            box-shadow: 0 8px 16px 0 rgb(32 32 32 / 8%);
        }
        .my_input3{
            height: 40px;
            width: 520px;
            vertical-align: middle;
            margin-top: 20px;
            padding-left: 24px;
            color: #202020;
            font-size: 18px;
            border: 0;
            border-radius: 16px;
            box-shadow: 0 8px 16px 0 rgb(32 32 32 / 8%);
        }
        .button {
            height: 50px;
            margin: 20px 10px 0px;
        }
        .flex_btn{
            display: flex;
            align-content: center;
        }
    </style>
</head>
<body>
{% include 'mainHeader.html' %}
<div class="wrap">
    <div class="myPageMenu">
        {% include 'myPageMenu.html' %}
    </div>
    <div class="section">
        <h3 class="subtitle">ğŸ”’ ê°œì¸ì •ë³´ìˆ˜ì •</h3>
        <div class="section2">
            <form method="post" action="userInfoUpdate?user={{ user_info.userid }}">
            <table>
                {#                <tr>#}
                {#                    <th>ì„±ëª…</th>#}
                {#                    <td>{{ user_info.name }}</td>#}
                {#                </tr>#}
                <tr>
                    <th class="info_title">ì•„ì´ë””</th>
                    <td><p class="my_input3">{{ user_info.userid }}</p></td>
                </tr>
                <tr>
                    <th class="info_title">ë‹‰ë„¤ì„</th>
                    <td><input class="my_input" type="text" name="nickname" value="{{ user_info.profile_name }}"></td>
                </tr>
                <tr>
                    <th class="info_title">ë¹„ë°€ë²ˆí˜¸</th>
                    <td><input class="my_input" type="password" name="pwd" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"></td>
                </tr>
                <tr>
                    <th class="info_title">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</th>
                    <td>
                        <input class="my_input" type="password" name="pwdchk" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸">
                        <span class="chkResult" id="pwChkSpan"></span>
                    </td>
                </tr>
                {% if user_info.role == 'guide' %}
                <tr>
                    <th class="info_title">ì£¼ì†Œ</th>
                    <td class="post">
                        <div class="flex_btn">
                            <input class="my_input2" type="text" id="sample6_postcode" name="postcode"
                                   value="{{ user_info.address }}" readonly>
                            <input type="button" id="postbtn" class="button" onclick="sample6_execDaumPostcode()"
                                   value="ìš°í¸ë²ˆí˜¸ ì°¾ê¸°"><br>
                        </div>
                        <input class="my_input" type="text" id="sample6_address" name="address" value="{{ user_info.address }}"><br>
                        <input class="my_input" type="text" id="sample6_detailAddress" name="address2" value="{{ user_info.address }}"><br>
                    </td>
                </tr>
                {% endif %}
{#                <tr>#}
{#                    <th>ìƒë…„ì›”ì¼</th>#}
{#                    <td>{{ user_info.birth }}</td>#}
{#                </tr>#}
                <tr>
                    <th class="info_title">íœ´ëŒ€í°</th>
                    <td><input class="my_input" type="tel" name="tel" value="{{ user_info.phone }}"></td>
                </tr>
                <tr>
                    <th class="info_title">ì´ë©”ì¼</th>
                    <td><input class="my_input" type="email" name="email1" value="{{ user_info.email }}"></td>
                </tr>
            </table>

            <div>
                <button type="submit" id="updatebtn" class="button">ìˆ˜ì •</button>
                <button type="button" id="cancel" class="button" onclick="location.href='/mypage'">ì·¨ì†Œ</button>
            </div>
        </form>
        </div>
    </div>
</div>
</body>
</html>
